rule "System started"
when
    System started
then
    presAll.sendCommand(OFF) // assume no one is home on startup
    presBlePeter.sendCommand(OFF)
    presBleMarina.sendCommand(OFF)
    presMobilePeter.sendCommand(OFF)
    presMobileMarina.sendCommand(OFF)
end

rule "Presence master"
when
	Item gPresent changed
then
	if (ON != cfgPersistanceEnable.state) {
		logInfo("presence", "Presence disabled")
		return
	}

	logInfo("presence", "Presence master: " + gPresent.state)

	if (ON == gPresent.state)
	{
		presAll.sendCommand(ON)
	} else {
		presAll.sendCommand(OFF)
	}
end

rule "Waterleak"
when
	Item kg_water_leak_1 changed to ON
then
	sendBroadcastNotification("WATER LEAK IN KG!")
	logWarn("water-leak", "WATER LEAK IN KG!")
end
