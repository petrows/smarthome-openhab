rule "Astro: sunset"
when
    // Sunset (early)
    Channel "astro:sun:home:set#event" triggered START
then
    logWarn("astro", "Sun: set")

    // If enabled - close curtains
    if (ON == sz_curtain_auto.state) {
        sz_curtain_switch.sendCommand("close")
    }
end

rule "Astro: civil dawn"
when
    // Civil Dawn (early)
    Channel "astro:sun:home:civilDawn#event" triggered START
then
    logWarn("astro", "Sun: civilDawn")

    // If enabled - close curtains
    if (ON == sz_curtain_auto.state) {
        sz_curtain_switch.sendCommand("open")
    }
end

// Update astro items

rule "Astro: update Sun"
when
    Item astro_sun_el changed
then
    // Sun is above horisont?
    if (newState > 0.0 | °) {
        astro_is_dark.sendCommand(OFF)
    } else {
        astro_is_dark.sendCommand(ON)
    }

    // Night?
    if (newState < 5.0 | °) {
        astro_is_night.sendCommand(ON)
    } else {
        astro_is_night.sendCommand(OFF)
    }
end
