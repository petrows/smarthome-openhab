rule "Astro: sunset"
when
    // Sunset (early)
    Channel "astro:sun:home:set#event" triggered START
then
    logWarn("astro", "Sun: set")

    // If enabled - close curtains
    if (ON == sz_curtain_auto.state) {
        sz_curtain_switch.sendCommand("close")
    }
end

rule "Astro: civil dawn"
when
    // Civil Dawn (early)
    Channel "astro:sun:home:civilDawn#event" triggered START
then
    logWarn("astro", "Sun: civilDawn")

    // If enabled - close curtains
    if (ON == sz_curtain_auto.state) {
        sz_curtain_switch.sendCommand("open")
    }
end

// Update astro items

rule "Astro: update Sun"
when
    Item astro_sun_el changed
then
    // Sun going low
    if (newState > 5.0 | °) {
        if (astro_sun_up_5.state != ON) astro_sun_up_5.sendCommand(ON)
    } else {
        if (astro_sun_up_5.state != OFF) astro_sun_up_5.sendCommand(OFF)
    }
    // Sun leaving
    if (newState > 0.0 | °) {
        if (astro_sun_up_0.state != ON) astro_sun_up_0.sendCommand(ON)
    } else {
        if (astro_sun_up_0.state != OFF) astro_sun_up_0.sendCommand(OFF)
    }
end
