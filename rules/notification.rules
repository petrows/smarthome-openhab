rule "Washmachine notify"
when
	Item washMachinePower changed from ON to OFF
then
	sendCommand(miGwSoundVolume, 15)
	sendCommand(miGwSound, 10003)
	sendBroadcastNotification("Waschmachine: DONE")
end

rule "Online notify"
when
	Item gOnline changed
then

	var notifyMsg = ""
	
	if (ON == gOnline.state) {
		logInfo("online", "All devices online")
		notifyMsg = "All devices online"
	} else {
		val offlineDevices = gOnline.members.filter[ dev | dev.state == OFF ]		
		val devList = newArrayList()		
		offlineDevices.forEach[ dev, index | 
			devList.add(dev.label)
		]
		logInfo("online", "OFFLINE: " + devList.join(", "))
		notifyMsg = "OFFLINE: " + devList.join(",")
	}
	sendBroadcastNotification(notifyMsg)
end

rule "LowBattery notify"
when
	Item gBattery changed from OFF to ON
then
	sendBroadcastNotification("Battery warning")
end

